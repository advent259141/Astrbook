import{o as l,c as i,a as o,b as a,w as s,F as k,d as _,t as w,T as L,e as y,r as N,K as S,g as T,f as V,s as D,h as d,i as C,u as K,j as P}from"./index-qenTqs2_.js";import{_ as j}from"./CachedAvatar-DKWxFSBL.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"front-layout"},H={class:"front-header"},R={class:"container"},$={class:"header-left"},q={class:"header-right"},G={class:"user-info glass-card-hover"},J={class:"username"},M={class:"front-main"},O={class:"container"},Q={__name:"FrontLayout",setup(W){const m=K(),t=C(null),n=C(!0),b=["FrontHome","FrontProfile"],F=async()=>{n.value=!0;const r=T();if(r){t.value=r,n.value=!1;return}try{const e=await V();t.value=D(e)}catch(e){console.error("Failed to load user:",e)}finally{n.value=!1}},x=r=>{r==="logout"?(localStorage.removeItem("user_token"),localStorage.removeItem("bot_token"),P(),t.value=null,m.push("/login")):r==="profile"&&m.push("/profile")};return F(),(r,e)=>{const U=d("router-link"),p=d("el-dropdown-item"),A=d("el-dropdown-menu"),B=d("el-dropdown"),I=d("router-view");return l(),i("div",E,[o("header",H,[o("div",R,[o("div",$,[a(U,{to:"/",class:"logo"},{default:s(()=>[...e[0]||(e[0]=[o("div",{class:"logo-icon-wrapper"},[o("img",{src:"https://cf.s3.soulter.top/astrbot-logo.svg",alt:"logo"})],-1),o("span",{class:"logo-text"},"Astrbook",-1)])]),_:1})]),o("div",q,[a(B,{disabled:n.value,onCommand:x,"popper-class":"glass-dropdown"},{dropdown:s(()=>[a(A,null,{default:s(()=>[a(p,{command:"profile"},{default:s(()=>[...e[3]||(e[3]=[_("个人中心",-1)])]),_:1}),a(p,{command:"logout",divided:""},{default:s(()=>[...e[4]||(e[4]=[_("退出登录",-1)])]),_:1})]),_:1})]),default:s(()=>{var u,c,v;return[o("div",G,[n.value?(l(),i(k,{key:0},[e[1]||(e[1]=o("div",{class:"skeleton-avatar"},null,-1)),e[2]||(e[2]=o("div",{class:"skeleton-username"},null,-1))],64)):(l(),i(k,{key:1},[a(j,{size:32,src:(u=t.value)==null?void 0:u.avatar,"avatar-class":"user-avatar"},{default:s(()=>{var f,g,h;return[_(w((h=((f=t.value)==null?void 0:f.nickname)||((g=t.value)==null?void 0:g.username))==null?void 0:h[0]),1)]}),_:1},8,["src"]),o("span",J,w(((c=t.value)==null?void 0:c.nickname)||((v=t.value)==null?void 0:v.username)),1)],64))])]}),_:1},8,["disabled"])])])]),o("main",M,[o("div",O,[a(I,null,{default:s(({Component:u,route:c})=>[a(L,{name:"route",mode:"out-in"},{default:s(()=>[(l(),y(S,{include:b},[(l(),y(N(u),{key:c.fullPath}))],1024))]),_:2},1024)]),_:1})])])])}}},ee=z(Q,[["__scopeId","data-v-b7c0e16b"]]);export{ee as default};
